{"ast":null,"code":"import _objectSpread from\"/Users/romarumarchyk/Desktop/MyGitLabHW/react-redux/node_modules/@babel/runtime/helpers/esm/objectSpread2.js\";import{ADD_TO_CART,SET_CART_COUNT,INCREMENT,DICREMENT,REMOVE_FROM_CART,CLEAN_CART}from\"./actions\";import produce from'immer';var initialState={cart:JSON.parse(localStorage.getItem(\"cart\"))||[],cartCount:JSON.parse(localStorage.getItem(\"cartCount\"))||0};var cartReducer=function cartReducer(){var state=arguments.length>0&&arguments[0]!==undefined?arguments[0]:initialState;var action=arguments.length>1?arguments[1]:undefined;switch(action.type){case ADD_TO_CART:{return produce(state,function(draftState){var index=draftState.cart.findIndex(function(el){return el.article===action.payload.article;});var currentCard=_objectSpread({},action.payload);if(index===-1){currentCard.count=1;draftState.cart.push(currentCard);}else{draftState.cart[index].count+=1;}localStorage.setItem(\"cart\",JSON.stringify(draftState.cart));});}case SET_CART_COUNT:{return produce(state,function(draftState){draftState.cartCount=draftState.cart.reduce(function(sum,current){return sum+current.count;},0);localStorage.setItem(\"cartCount\",JSON.stringify(draftState.cartCount));});}case INCREMENT:{return produce(state,function(draftState){var idx=draftState.cart.findIndex(function(el){return el.article===action.payload;});draftState.cart[idx].count+=1;localStorage.setItem(\"cart\",JSON.stringify(draftState.cart));});}case DICREMENT:{return produce(state,function(draftState){var idx=draftState.cart.findIndex(function(el){return el.article===action.payload;});if(draftState.cart[idx].count>1){draftState.cart[idx].count-=1;localStorage.setItem(\"cart\",JSON.stringify(draftState.cart));}});}case REMOVE_FROM_CART:{return produce(state,function(draftState){var idx=draftState.cart.findIndex(function(el){return el.article===action.payload;});draftState.cart.splice(idx,1);localStorage.setItem(\"cart\",JSON.stringify(draftState.cart));});}case CLEAN_CART:{return produce(state,function(draftState){console.log(draftState.cart);draftState.cart=[];localStorage.setItem(\"cart\",JSON.stringify(draftState.cart));});}default:{return state;}}};export default cartReducer;","map":{"version":3,"names":["ADD_TO_CART","SET_CART_COUNT","INCREMENT","DICREMENT","REMOVE_FROM_CART","CLEAN_CART","produce","initialState","cart","JSON","parse","localStorage","getItem","cartCount","cartReducer","state","action","type","draftState","index","findIndex","el","article","payload","currentCard","count","push","setItem","stringify","reduce","sum","current","idx","splice","console","log"],"sources":["/Users/romarumarchyk/Desktop/MyGitLabHW/react-redux/src/store/cart/cartReducer.js"],"sourcesContent":["import { ADD_TO_CART, SET_CART_COUNT, INCREMENT, DICREMENT, REMOVE_FROM_CART, CLEAN_CART } from \"./actions\";\n\nimport produce from 'immer';\n\n\nconst initialState = {\n    cart: JSON.parse(localStorage.getItem(\"cart\")) || [],\n    cartCount: JSON.parse(localStorage.getItem(\"cartCount\")) || 0,\n}\n\nconst cartReducer = (state = initialState, action) => {\n\n    switch (action.type) {\n\n        case ADD_TO_CART: {\n            return produce(state, draftState => {\n\n                const index = draftState.cart.findIndex(el => el.article === action.payload.article)\n                const currentCard = { ...action.payload }\n\n                if (index === -1) {\n\n                    currentCard.count = 1\n                    draftState.cart.push(currentCard);\n\n                } else {\n\n                    draftState.cart[index].count += 1;\n\n                }\n\n                localStorage.setItem(\"cart\", JSON.stringify(draftState.cart));\n\n            });\n        }\n\n        case SET_CART_COUNT: {\n            return produce(state, draftState => {\n\n                draftState.cartCount = draftState.cart.reduce((sum, current) => sum + current.count, 0);\n\n                localStorage.setItem(\"cartCount\", JSON.stringify(draftState.cartCount));\n\n            })\n\n        }\n\n        case INCREMENT: {\n            return produce(state, draftState => {\n                const idx = draftState.cart.findIndex(el => el.article === action.payload)\n                draftState.cart[idx].count += 1\n                localStorage.setItem(\"cart\", JSON.stringify(draftState.cart));\n            })\n\n        }\n\n        case DICREMENT: {\n            return produce(state, draftState => {\n\n                const idx = draftState.cart.findIndex(el => el.article === action.payload)\n\n                if (draftState.cart[idx].count > 1) {\n                    draftState.cart[idx].count -= 1\n                    localStorage.setItem(\"cart\", JSON.stringify(draftState.cart));\n                }\n\n            })\n        }\n\n        case REMOVE_FROM_CART: {\n            return produce(state, draftState => {\n\n                const idx = draftState.cart.findIndex(el => el.article === action.payload)\n                draftState.cart.splice(idx, 1)\n                localStorage.setItem(\"cart\", JSON.stringify(draftState.cart));\n\n            })\n        }\n\n        case CLEAN_CART: {\n            return produce(state, draftState => {\n                console.log(draftState.cart);\n\n                draftState.cart = []\n                localStorage.setItem(\"cart\", JSON.stringify(draftState.cart));\n\n            })\n        }\n\n        default: {\n            return state\n        }\n    }\n}\n\nexport default cartReducer"],"mappings":"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"},"metadata":{},"sourceType":"module"}